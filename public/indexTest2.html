<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FTTNQMESXD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-FTTNQMESXD");
    </script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Mappy Hour</title>
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />

    <!-- Font Awesome icons (free version)-->
    <script src="https://code.jquery.com/jquery-3.6.0.js"
    integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://use.fontawesome.com/releases/v6.7.2/js/all.js" crossorigin="anonymous"></script>

    <!-- MAPBOX -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.css" rel="stylesheet">

    <!-- LEAFLET -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <!-- Leaflet Search Plugin -->
    <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet-search@3.0.0/dist/leaflet-search.min.css"
    />

    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css" />

    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    <link href="css/nav-style.css" rel="stylesheet" />
  </head>
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand" href="#page-top">Mappy Hour</a>
        <button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-2 px-0 px-lg-3 rounded" href="#quizzo">Quizzo Map</a></li>
            <!-- <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-2 px-0 px-lg-3 rounded" href="#restaurant-week">Restaurant Week</a></li> -->
            <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-2 px-0 px-lg-3 rounded"href="#meet-the-team">Meet The Team</a></li>
            <!-- <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-2 px-0 px-lg-3 rounded" href="#sips">Sips Deals</a></li> -->
            <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-2 px-0 px-lg-3 rounded" href="#deals">Happy Hour Deals</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Masthead -->
    <!-- <header class="masthead text-white text-center "> -->
    <header class="masthead bg-primary text-white text-center gradient">
      <!-- <div class="background"></div> -->
      <div class="container d-flex align-items-center flex-column">
        <div class="px-5 pt-5 v-middle">
          <!-- Masthead Avatar Image-->
          <img
            class="masthead-avatar mb-5"
            src="assets/img/mappyHour.png"
            alt="..."
          />
          <!-- Masthead Heading-->
          <h1 class="masthead-heading text-uppercase mb-0 text-longshadow">
            Mappy Hour
          </h1>
          <!-- Icon Divider-->
          <div class="divider-custom divider-light">
            <div class="divider-custom-line"></div>
            <div class="divider-custom-icon">
              <i class="fa-solid fa-earth-americas"></i>
            </div>
            <div class="divider-custom-line"></div>
          </div>
          <!-- Masthead Subheading-->
          <p class="masthead-subheading font-weight-light">
            A Louie and Ava Production (Version 0.9)
          </p>
        </div>
      </div>
    </header>

    <!-- Bar Trivia Section-->
    <section class="page-section portfolio" id="quizzo">
      <div class="container">
        <!-- Portfolio Section Heading-->
        <h2 class="page-section-heading text-center text-uppercase text-secondary mb-0">
          Philly Quizzo Map
        </h2>
        <!-- Icon Divider-->
        <div class="divider-custom">
          <div class="divider-custom-line"></div>
          <div class="divider-custom-icon">
            <i class="fa-solid fa-earth-americas"></i>
          </div>
          <div class="divider-custom-line"></div>
        </div>
        
        <!-- <iframe
          src="quizzo_map.html"
          width="100%"
          height="70vh"
          class="maps"
        ></iframe> -->
        <p></p>

        <div id="filters" class="filter-box mb-3">
          <!-- Weekday Filter -->
          <div id="weekday-filter">
            <button id="weekday-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-calendar-week" style="margin-right: 8px;"></i>
              Weekday
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="weekday-dropdown">
              <ul style="list-style: none; margin: 0; padding: 10px;">
                <li class="weekday-option" data-value="All">All</li>
                <li class="weekday-option" data-value="MONDAY">Monday</li>
                <li class="weekday-option" data-value="TUESDAY">Tuesday</li>
                <li class="weekday-option" data-value="WEDNESDAY">Wednesday</li>
                <li class="weekday-option" data-value="THURSDAY">Thursday</li>
                <li class="weekday-option" data-value="FRIDAY">Friday</li>
                <li class="weekday-option" data-value="SATURDAY">Saturday</li>
                <li class="weekday-option" data-value="SUNDAY">Sunday</li>
              </ul>
            </div>
          </div>
        
          <!-- Start Time Filter -->
          <div id="time-filter">
            <button id="time-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-clock" style="margin-right: 8px;"></i>
              Start Time
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="time-dropdown">
              <ul style="list-style: none; margin: 0; padding: 10px;" id="time-options">
              </ul>
            </div>
          </div>
          <!-- Event Type Filter -->
          <div id="event-type-filter">
            <button id="event-type-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-tags" style="margin-right: 8px;"></i>
              Event Type
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="event-type-dropdown">
              <ul style="list-style: none; margin: 0; padding: 10px;" id="event-type-options"></ul>
            </div>
          </div>
        
          <!-- First Prize Filter -->
          <div id="first-prize-filter">
            <button id="first-prize-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-trophy" style="margin-right: 8px;"></i>
              First Prize
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="first-prize-dropdown">
              <ul style="list-style: none; margin: 0; padding: 10px;" id="first-prize-options"></ul>
            </div>
          </div>

          <!-- Neighborhood Filter -->
          <!-- <div id="neighborhood-filter">
            <button id="neighborhood-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-map-marker-alt" style="margin-right: 8px;"></i>
              Neighborhood
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="neighborhood-dropdown">
              <ul style="list-style: none; margin: 0; padding: 10px;" id="neighborhood-options"></ul>
            </div>
          </div> -->
          
          <div id="neighborhood-filter">
            <button id="neighborhood-button" class="btn btn-primary rounded-pill">
              <i class="fa-solid fa-map-marker-alt" style="margin-right: 8px;"></i>
              Neighborhood
              <i class="fa-solid fa-caret-down" style="margin-left: 8px;"></i>
            </button>
            <div id="neighborhood-dropdown" style="display: none; position: absolute; background: white; border: 1px solid #ccc; border-radius: 8px; box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); z-index: 1000; width: 200px;">
              <input
                type="text"
                id="neighborhood-search"
                placeholder="Search Neighborhood"
                style="width: 95%; padding: 5px; border: none; border-bottom: 1px solid #ccc; box-sizing: border-box;"
              />
              <ul
                id="neighborhood-options"
                style="list-style: none; margin: 0; padding: 10px; max-height: 200px; overflow-y: auto;"
              ></ul>
            </div>
          </div>
        </div>

        <div id="map"></div>

        <div id="action-buttons" style="display: flex; gap: 20px; justify-content: center; margin-top: 20px;">
          <!-- Add New Bar Button -->
          <button id="add-bar-button" class="btn btn-primary rounded-pill">
            <i class="fa-solid fa-plus" style="margin-right: 8px;"></i>
            Add New Bar
          </button>
        
          <!-- Edit Bar Info Button -->
          <button id="edit-bar-button" class="btn btn-primary rounded-pill">
            <i class="fa-solid fa-edit" style="margin-right: 8px;"></i>
            Edit Bar Info
          </button>
        </div>
        
        <!-- Add New Bar Form -->
        <div id="add-bar-container" class="container mt-4" style="display: none;">
          <h3 class="text-center">Submit a Bar Quizzo Information</h3>
          <form id="bar-submission-form">
            <div class="mb-3">
              <label for="business-name" class="form-label">Business Name</label>
              <input type="text" class="form-control" id="business-name" placeholder="Enter the bar's name" required />
            </div>
            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <input type="text" class="form-control" id="address" placeholder="Enter the bar's address" required />
            </div>
            <div class="mb-3">
              <label for="weekday" class="form-label">Weekday</label>
              <select class="form-control" id="weekday">
                <option value="MONDAY">Monday</option>
                <option value="TUESDAY">Tuesday</option>
                <option value="WEDNESDAY">Wednesday</option>
                <option value="THURSDAY">Thursday</option>
                <option value="FRIDAY">Friday</option>
                <option value="SATURDAY">Saturday</option>
                <option value="SUNDAY">Sunday</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="time" class="form-label">Start Time</label>
              <input type="time" class="form-control" id="time" required />
            </div>
            <div class="mb-3">
              <label for="event-type" class="form-label">Event Type</label>
              <input type="text" class="form-control" id="event-type" placeholder="Enter the event type" />
            </div>
            <div class="mb-3">
              <label for="first-prize" class="form-label">First Prize</label>
              <input type="text" class="form-control" id="first-prize" placeholder="Enter the first prize" />
            </div>
            <div class="mb-3">
              <label for="second-prize" class="form-label">Second Prize</label>
              <input type="text" class="form-control" id="second-prize" placeholder="Enter the second prize" />
            </div>
            <div class="mb-3">
              <label for="host" class="form-label">Host</label>
              <input type="text" class="form-control" id="host" placeholder="Enter the host's name" />
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>
        
        <!-- Edit Bar Info Form -->
        <div id="edit-bar-container" class="container mt-4" style="display: none;">
          <h3 class="text-center">Edit Bar Quizzo Information</h3>
          <form id="edit-bar-form">
            <div class="mb-3">
              <label for="search-bar" class="form-label">Search Bar</label>
              <input type="text" class="form-control" id="search-bar" placeholder="Search for a bar by name" />
              <ul id="search-results" style="list-style: none; padding: 0; margin-top: 10px;"></ul>
            </div>
            <div id="edit-fields" style="display: none;">
              <div class="mb-3">
                <label for="edit-business-name" class="form-label">Business Name</label>
                <input type="text" class="form-control" id="edit-business-name" required />
              </div>
              <div class="mb-3">
                <label for="edit-address" class="form-label">Address</label>
                <input type="text" class="form-control" id="edit-address" required />
              </div>
              <div class="mb-3">
                <label for="edit-weekday" class="form-label">Weekday</label>
                <select class="form-control" id="edit-weekday">
                  <option value="MONDAY">Monday</option>
                  <option value="TUESDAY">Tuesday</option>
                  <option value="WEDNESDAY">Wednesday</option>
                  <option value="THURSDAY">Thursday</option>
                  <option value="FRIDAY">Friday</option>
                  <option value="SATURDAY">Saturday</option>
                  <option value="SUNDAY">Sunday</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="edit-time" class="form-label">Start Time</label>
                <input type="time" class="form-control" id="edit-time" required />
              </div>
              <div class="mb-3">
                <label for="edit-event-type" class="form-label">Event Type</label>
                <input type="text" class="form-control" id="edit-event-type" />
              </div>
              <div class="mb-3">
                <label for="edit-first-prize" class="form-label">First Prize</label>
                <input type="text" class="form-control" id="edit-first-prize" />
              </div>
              <div class="mb-3">
                <label for="edit-second-prize" class="form-label">Second Prize</label>
                <input type="text" class="form-control" id="edit-second-prize" />
              </div>
              <div class="mb-3">
                <label for="edit-host" class="form-label">Host</label>
                <input type="text" class="form-control" id="edit-host" />
              </div>
              <button type="submit" class="btn btn-primary">Submit Changes</button>
            </div>
          </form>
        </div>
        <!-- <div class="row">
          <div class="col-2"></div>
          <img class="custom-col mb-3 align-items-center" src="assets/img/error.png" />
          <div class="col-2"></div>
        </div> -->

      </div>
    </section>

    <!-- Footer-->
    <footer class="footer text-center">
      <div class="container">
        <div class="row">
          <!-- Footer Location-->
          <div class="col-lg-4 mb-5 mb-lg-0">
            <h4 class="text-uppercase mb-4">Location</h4>
            <p class="lead mb-0">
              Philadelphia
              <br />
              PA, USA
            </p>
            <a style="text-decoration: underline; font-size: 12px;" class="nav-link py-2 px-0 px-lg-3 rounded" href="birthday.html"
                >Birthday Boy</a
              >
          </div>
          <!-- Footer Social Icons-->
          <div class="col-lg-4 mb-5 mb-lg-0">
            <h4 class="text-uppercase mb-4">Around the Web</h4>
            <a
              class="btn btn-outline-light btn-social mx-1"
              href="https://youtu.be/zsX-4LThKv4"
              target="_blank"
              ><i class="fab fa-fw fa-youtube"></i
            ></a>
            <a
              class="btn btn-outline-light btn-social mx-1"
              href="https://www.linkedin.com/in/ava-patterson-aip5302/"
              target="_blank"
              ><i class="fab fa-fw fa-linkedin-in"></i
            ></a>
            <a
              class="btn btn-outline-light btn-social mx-1"
              href="https://www.linkedin.com/in/louis-rodriguez-9b6187128/"
              target="_blank"
              ><i class="fab fa-fw fa-linkedin-in"></i
            ></a>
            <a
              class="btn btn-outline-light btn-social mx-1"
              href="https://github.com/LouieR3/Philly-Happy-Hour-Map"
              target="_blank"
              ><i class="fab fa-fw fa-github"></i
            ></a>
          </div>
          <!-- Footer About Text-->
          <div class="col-lg-4">
            <h4 class="text-uppercase mb-4">Other Sites</h4>
            <p class="lead mb-0">
              Visit
              <a
                style="color: white"
                href="https://louier3-fantasy-football-page.streamlit.app/"
                target="_blank"
              >
                Louie's fantasy football web app here</a
              >, with his world renowned "Louie Power Index (LPI)"
            </p>
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="js/jquery-3.0.0.min.js"></script> -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
    <script src="js/jquery.sticky.js"></script>
    <!-- Main JS -->
    <script src="js/main.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
    <!-- MAPBOX -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.js"></script>
    <!-- LEAFLET -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
    <!-- <script src="https://unpkg.com/leaflet-search@3.0.0/dist/leaflet-search.min.js"></script> -->
    <script src="https://opengeo.tech/maps/leaflet-search/src/leaflet-search.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/fuse.js/1.2.2/fuse.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>

    <!-- Papa Parse -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://opengeo.tech/maps/leaflet-search/examples/data/restaurant500.geojson.js"></script>
    
    <script>
        var map = L.map('map', {
            zoom: 12,
            center: new L.latLng(39.9526, -75.1652), // Centered on Philadelphia
            layers: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
        });

        // Load GeoJSON from the Quizzo folder
        fetch('map.geojson')
        .then(response => response.json())
        .then(data => {
            // Add GeoJSON layer to the map
            var geoJsonLayer = L.geoJSON(data, {
                pointToLayer: function (feature, latlng) {
                    // Extend properties with default values
                    var props = L.Util.extend(
                    {
                        BUSINESS: 'No Name',
                        ADDRESS_STREET: 'No Address',
                        ADDRESS_CITY: '',
                        ADDRESS_STATE: '',
                        ADDRESS_ZIP: ''
                    },
                    feature.properties
                    );

                    // Create popup content using L.Util.template
                    var popupContent = L.Util.template(
                    `<h3>{BUSINESS}</h3>
                    <p>{ADDRESS_STREET}, {ADDRESS_CITY}, {ADDRESS_STATE} {ADDRESS_ZIP}</p>`,
                    props
                    );

                    // Define marker style
                    var style = {
                    radius: 5,
                    opacity: 0.8,
                    fillColor: '#ddd',
                    fillOpacity: 0.8
                    };

                    // Return a circle marker with the popup
                    return L.circleMarker(latlng, style).bindPopup(popupContent);
                }
                }).addTo(map);

            // Add search functionality
            var fuse = new Fuse(data.features, {
                keys: [
                    'properties.BUSINESS',
                    'properties.ADDRESS_STREET'
                ]
            });

            L.control.search({
                layer: geoJsonLayer,
                propertyName: 'BUSINESS',
                filterData: function (text, records) {
                    var jsons = fuse.search(text),
                    ret = {},
                    key;

                    for (var i in jsons) {
                        key = jsons[i].item.properties.BUSINESS;
                        if (key) {
                            ret[key] = records[key];
                        }
                        // ret[key] = records[key];
                    }

                    console.log(jsons, ret);
                    return ret;
                }
            })
            .on('search:locationfound', function (e) {
                e.layer.openPopup();
            })
            .addTo(map);
        })
        .catch(error => console.error('Error loading GeoJSON:', error));

    </script>
  </body>
</html>
